require_relative 'config'
require 'rake'

desc "Start Sinatra app with rerun for auto-reload"
task :dev do
  sh 'bundle exec rerun --ignore "*.{erb,js,css}" --force-polling "rackup --host 0.0.0.0"'
end

desc "Fill the database with initial data from the seeder file"
task :seed do
  require_relative './db/seeder'
  puts "âœ… Database done seeding!"
end

desc "Default task: seeds database if no db file exists (#{DB_PATH}), then start dev server"
task default: [] do
  if !File.exist?(DB_PATH)
    puts "ğŸ“¦ No database found - running seed task..."
    Rake::Task[:seed].invoke
  else
    puts "ğŸš€ Database found - starting app..."
  end
  Rake::Task[:dev].invoke
end
